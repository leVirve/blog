<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Salas&#39;</title>
  <subtitle>Do it for your pride.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://levirve.github.io/"/>
  <updated>2016-08-16T03:33:40.910Z</updated>
  <id>https://levirve.github.io/</id>
  
  <author>
    <name>Salas (leVirve)</name>
    <email>gae.m.project@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Dcard çˆ¬èŸ²æ–¼ Python å¯¦ä½œæˆæœï¼šdcard-spider</title>
    <link href="https://levirve.github.io/2016/dcard-spider-python-package/"/>
    <id>https://levirve.github.io/2016/dcard-spider-python-package/</id>
    <published>2016-07-30T09:24:44.000Z</published>
    <updated>2016-08-16T03:33:40.910Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šæ¬¡è«‡åˆ°äº† Dcard ç¾åœ¨å®˜æ–¹å¯¦éš› production ä¸­ä½¿ç”¨çš„ API URL è¦å‰‡ï¼Œä¸¦ä¸”æ’°å¯«äº†ç°¡å–®çš„ Python scripts ä¾†å–å¾—å°éƒ¨åˆ†è³‡æ–™ã€‚<br>è€Œé€™æ¨£çš„æˆæœé©åˆç”¨ä¾†åšå°è¦æ¨¡çš„å¾ŒçºŒæ‡‰ç”¨ï¼Œä¾‹å¦‚ç‰¹å®šç‰ˆçš„ç•¶æ—¥æˆ–ç•¶æœˆæ–‡ç« åˆ†æç­‰ç­‰ï¼›ç„¶è€Œè‹¥æ˜¯è¦æ‹¿ä¸‹å…¨ç«™çš„è³‡æ–™ï¼Œé‚£éº¼æˆ‘å€‘ä¸Šæ¬¡çš„ç¨‹å¼ç¯„ä¾‹æœ¬èº«å¿…é ˆè¦æ”¹å–„ä¾†è®“å¾ŒçºŒæ–¹ä¾¿æ“´å……ï¼ˆå…¶å¯¦æ˜¯ä¸Šæ¬¡ç¨‹å¼è¶•å·¥å¯«å¤ªé†œï¼Œç”Ÿç†ä¸Šä¸èƒ½æ¥å—(?) å®Œå…¨æ²’æœ‰æƒ³è¦ç›´æ¥æ²¿ç”¨çš„å¿µé ­ XDï¼‰ã€‚</p>
<p>é‚£éº¼æ¥ä¸‹ä¾†çš„æ¦‚å¿µå°±æ˜¯ï¼š</p>
<ol>
<li><p>æˆ‘è¦ä¸€éš»å¤§èœ˜è››ï¼ˆæ¯”èµ· crawlerï¼Œæˆ‘é¸æ“‡ Spiderï¼è½èµ·ä¾†å°±æ¯”è¼ƒçŒ›ï¼Œä»¥ä¸‹éƒ½ç”¨ spider ç¨±å‘¼é€™éš»ç¶²è·¯çˆ¬èŸ² é¡†é¡†ï¼‰</p>
<img src="/2016/dcard-spider-python-package/Giant_spider_strikes.jpg" alt="[Giant spider strikes from wiki]" title="[Giant spider strikes from wiki]">
</li>
<li><p>é‚£é™¤äº†æ ¸å¿ƒçš„è»€å¹¹ä¹‹å¤–éœ€è¦å…ˆé€ å…«éš» <del>èŸ¹</del> è…³å•Šï¼ä¸Šæ¬¡é‚£å€‹å“è³ªï¼ï¼ï¼å¯æ˜¯æ’ä¸èµ·é€™éš»å·¨å‹èœ˜è››çš„</p>
</li>
<li><p>ä¸çŸ¥æ‰€äº‘ï¼Œç¸½ä¹‹å°±æ˜¯æŠŠä¹‹å‰çš„æ¦‚å¿µæ‰“é€ æˆå¥½ç”¨çš„è…¿å°±å°äº†ã€‚ä¹‹å¾Œèœ˜è››å¥½è¾¦äº‹ï¼</p>
</li>
</ol>
<p>æˆæœå·²ç¶“ç™¼å¸ƒåœ¨ <a href="https://pypi.python.org/pypi/dcard-spider" target="_blank" rel="external">PyPI</a> ä»¥åŠ <a href="https://github.com/leVirve/dcard-spider" target="_blank" rel="external">Github</a> ä¸Šäº†ã€‚</p>
<a id="more"></a>
<h2 id="u61F6_u4EBA_u5305_uFF0C_u6211_u5C31_u5148_u5B89_u88DD_u518D_u8AAA"><a href="#u61F6_u4EBA_u5305_uFF0C_u6211_u5C31_u5148_u5B89_u88DD_u518D_u8AAA" class="headerlink" title="æ‡¶äººåŒ…ï¼Œæˆ‘å°±å…ˆå®‰è£å†èªª"></a>æ‡¶äººåŒ…ï¼Œæˆ‘å°±å…ˆå®‰è£å†èªª</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install dcard-spider</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ <a href="https://pypi.python.org/pypi/dcard-spider" target="_blank" rel="external">dcard-spdier@PyPi</a> ä¸ä¿è­‰æœ‰ä»¥ä¸‹èªªçš„æœ€æ–°åŠŸèƒ½å”·ï¼Œå› ç‚ºæ²’æœ‰éš¨æ™‚ç™¼å¸ƒæœ€æ–°çš„ä¸Šå» XDD</p>
<h2 id="u61F6_u4EBA_u5305_uFF0C_u6211_u5C31_u52E4_u52DE_u4E00_u9EDE_u5230_Github__u88DD_u65B0_u7248"><a href="#u61F6_u4EBA_u5305_uFF0C_u6211_u5C31_u52E4_u52DE_u4E00_u9EDE_u5230_Github__u88DD_u65B0_u7248" class="headerlink" title="æ‡¶äººåŒ…ï¼Œæˆ‘å°±å‹¤å‹ä¸€é»åˆ° Github è£æ–°ç‰ˆ"></a>æ‡¶äººåŒ…ï¼Œæˆ‘å°±å‹¤å‹ä¸€é»åˆ° Github è£æ–°ç‰ˆ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/leVirve/dcard-spider</span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>
<p>è£å¥½ä¹‹å¾Œï¼Œå¯ä»¥å…ˆç…§è‘— README è£¡çš„ <code>command line</code> è©¦è©¦ä¸‹è¼‰åœ–ç‰‡åŠŸèƒ½ï¼Œæˆ–æ˜¯ç”¨ <code>program</code> è·‘ sample çœ‹çœ‹æ•ˆæœå¦‚ä½•ã€‚é‚£éº¼ä»¥ä¸‹åˆ†äº«æˆ‘çš„ Python packageï¼ˆå¥—ä»¶ï¼‰ç¨‹å¼æ¶æ§‹ï¼š</p>
<h2 id="u7A0B_u5F0F_u78BC"><a href="#u7A0B_u5F0F_u78BC" class="headerlink" title="ç¨‹å¼ç¢¼"></a>ç¨‹å¼ç¢¼</h2><p>å…ˆå®šç¾©ä¸€å€‹ <code>Dcard</code> é¡åˆ¥ä¾†æè¿°æ•´å€‹å¥—ä»¶æ‡‰è©²æœ‰çš„å­åŠŸèƒ½ï¼Œä¾‹å¦‚ç›®å‰æ”¯æ´ <code>forums</code> è·Ÿ <code>posts</code> å…©å€‹ APIï¼Œæ‰€ä»¥æˆ‘å®šç¾©äº†å…©å€‹å­é¡åˆ¥è² è²¬å„è‡ªåŠŸèƒ½ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">""" dcard.py """</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> dcard.forums <span class="keyword">import</span> Forum</span><br><span class="line"><span class="keyword">from</span> dcard.posts <span class="keyword">import</span> Post</span><br><span class="line"><span class="keyword">from</span> dcard.utils <span class="keyword">import</span> Client</span><br><span class="line"></span><br><span class="line">__all__ = [<span class="string">'Dcard'</span>]</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dcard</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(workers=<span class="number">8</span>)</span>:</span></span><br><span class="line">        self.client = Client(workers=workers)</span><br><span class="line">        self.forums = Forum(client=self.client)</span><br><span class="line">        self.posts = Post(client=self.client)</span><br></pre></td></tr></table></figure>
<h3 id="u770B_u677F_u6587_u7AE0_u76F8_u95DC_u8CC7_u8A0A__28Forum-layer_29"><a href="#u770B_u677F_u6587_u7AE0_u76F8_u95DC_u8CC7_u8A0A__28Forum-layer_29" class="headerlink" title="çœ‹æ¿æ–‡ç« ç›¸é—œè³‡è¨Š (Forum-layer)"></a>çœ‹æ¿æ–‡ç« ç›¸é—œè³‡è¨Š (Forum-layer)</h3><ul>
<li><p>åœ¨ <code>Forum</code> ä¸­ä¸»è¦æœ‰å…©å€‹å°å¤–ï¼ˆä½œç‚ºå¥—ä»¶æä¾›çµ¦å¤–éƒ¨å‘¼å«ï¼‰çš„æ–¹æ³•</p>
<ol>
<li><p><code>get()</code> ä½œç‚ºå¯¦ä¾‹æ–¹æ³• (instance method)</p>
<ul>
<li><p>ç”¨ä¾†å–å¾— <code>Dcard</code> ä¸Šå„å€‹çœ‹æ¿çš„å¾Œè¨­è³‡è¨Š (metadata)ï¼Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">metadata_forums = dcard.forums.get()</span><br></pre></td></tr></table></figure>
</li>
<li><p>API å–å¾—çš„çµæœæ˜¯ <code>json</code> çš„ listï¼ŒåŸå§‹è³‡æ–™å¤§æ¦‚é•·é€™æ¨£ï¼šï¼ˆä½†åœ¨ç¨‹å¼è£¡å°±è®Šæˆ list of <code>dict</code>ï¼‰</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  ...,</span><br><span class="line">  &#123;</span><br><span class="line">    "<span class="attribute">id</span>": <span class="value"><span class="string">"c82dae3f-28ba-4aae-961d-c754e6ccd37a"</span></span>,</span><br><span class="line">    "<span class="attribute">name</span>": <span class="value"><span class="string">"æ‰‹ä½œ"</span></span>,</span><br><span class="line">    "<span class="attribute">description</span>": <span class="value"><span class="string">"ä¾›è¨è«–ã€åˆ†äº«ã€è©¢å•å„ç¨®æ‰‹ä½œã€éæ–‡å­—å‰µä½œå“ï¼Œéç›¸é—œè©±é¡Œæœƒåˆªé™¤è©²æ–‡"</span></span>,</span><br><span class="line">    "<span class="attribute">alias</span>": <span class="value"><span class="string">"handicrafts"</span></span>,</span><br><span class="line">    "<span class="attribute">fullyAnonymous</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">    "<span class="attribute">subscriptionCount</span>": <span class="value"><span class="number">2893</span></span>,</span><br><span class="line">    "<span class="attribute">invisible</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">    "<span class="attribute">isSchool</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">    "<span class="attribute">read</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">    "<span class="attribute">subscribed</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">    "<span class="attribute">ignorePost</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">    "<span class="attribute">canPost</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">    "<span class="attribute">createdAt</span>": <span class="value"><span class="string">"2016-05-17T11:15:15.714Z"</span></span>,</span><br><span class="line">    "<span class="attribute">updatedAt</span>": <span class="value"><span class="string">"2016-07-15T10:50:49.208Z"</span></span><br><span class="line">  </span>&#125;, ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ‰æä¾›åƒæ•¸ <code>no_school</code> èª¿æ•´è¦ä¸è¦å­¸æ ¡çœ‹æ¿çš„è³‡è¨Šï¼Œå¾ä¸Šé¢çš„ <code>json</code> æ ¼å¼çœ‹å¾—å‡º <code>isSchool</code> çµ¦æˆ‘å€‘è¶³å¤ çš„è¨Šæ¯ä¾†åˆ¤æ–·</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">metadata_forums = dcard.forums.get()  <span class="comment"># å–å¾—æ‰€æœ‰çœ‹æ¿</span></span><br><span class="line">metadata_forums = dcard.forums.get(no_school=<span class="keyword">True</span>)  <span class="comment"># éæ¿¾æ‰å­¸æ ¡çœ‹æ¿</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>get_metas()</code> æ˜¯å¯¦ä¾‹æ–¹æ³• (instance method)</p>
<ul>
<li><p>ç”¨ä¾†å–å¾—å„ç¯‡æ–‡ç« çš„å¾Œè¨­è³‡è¨Š (metadata)ï¼Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">forum = dcard.forums(<span class="string">'funny'</span>)</span><br><span class="line">forum.get_metas()</span><br></pre></td></tr></table></figure>
</li>
<li><p>API å–å¾—çš„çµæœåŒæ¨£æ˜¯ <code>json</code> çš„ listï¼ŒåŸå§‹è³‡æ–™å¤§æ¦‚é•·é€™æ¨£ï¼šï¼ˆç¨‹å¼è£¡å°±æ˜¯ list of <code>dict</code>ï¼‰</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  ...</span><br><span class="line">  &#123;</span><br><span class="line">    "<span class="attribute">tags</span>": <span class="value">[<span class="string">"è€çˆ¸"</span>, <span class="string">"ä¸‰æœ¬"</span>, <span class="string">"ç½µäºº"</span>]</span>,</span><br><span class="line">    "<span class="attribute">title</span>": <span class="value"><span class="string">"è€çˆ¸ï¼Œä¸æ˜¯é€™æ¨£çš„å§ï¼ğŸ˜‚"</span></span>,</span><br><span class="line">    "<span class="attribute">forumName</span>": <span class="value"><span class="string">"æœ‰è¶£"</span></span>,</span><br><span class="line">    "<span class="attribute">anonymousSchool</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">    "<span class="attribute">forumAlias</span>": <span class="value"><span class="string">"funny"</span></span>,</span><br><span class="line">    "<span class="attribute">createdAt</span>": <span class="value"><span class="string">"2016-07-15T10:57:02.876Z"</span></span>,</span><br><span class="line">    "<span class="attribute">school</span>": <span class="value"><span class="string">"ä¸­å±±å¤§å­¸"</span></span>,</span><br><span class="line">    "<span class="attribute">commentCount</span>": <span class="value"><span class="number">0</span></span>,</span><br><span class="line">    "<span class="attribute">updatedAt</span>": <span class="value"><span class="string">"2016-07-15T10:57:02.876Z"</span></span>,</span><br><span class="line">    "<span class="attribute">forumId</span>": <span class="value"><span class="string">"a1aaa6e6-2594-4968-b7dc-e1b14bea96f4"</span></span>,</span><br><span class="line">    "<span class="attribute">likeCount</span>": <span class="value"><span class="number">0</span></span>,</span><br><span class="line">    "<span class="attribute">excerpt</span>": <span class="value"><span class="string">"é›–ç„¶å®¶åœ¨é«˜é›„ä½†ç”±æ–¼ä¸‹å­¸æœŸæ¯”è¼ƒå¿™æ‰€ä»¥ä¹Ÿå¾ˆå°‘å›å®¶\nï¼ˆé€™å¥½åƒä¸æ˜¯é‡é»ğŸ˜‚ï¼‰\n-\næ”¾æš‘å‡å¾Œç•¶ç„¶æ²’äº‹å°±è¶•ç·Šå›å®¶å•¦ï¼\nå‰å¹¾å¤©çœ‹åˆ°è€çˆ¸åœ¨çœ‹é›»è¦–ï¼Œçªç„¶è½åˆ°ä¸€é™£å¤§ç¬‘\nã€Œå“ˆå“ˆå“ˆå“ˆï¼Œäº”åå…­å•Šï¼Œå“ˆå“ˆå“ˆå“ˆã€\n-\næˆ‘å¿ƒè£¡æƒ³ï¼Œè›¤äº”"</span></span>,</span><br><span class="line">    "<span class="attribute">id</span>": <span class="value"><span class="number">224362465</span></span>,</span><br><span class="line">    "<span class="attribute">anonymousDepartment</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">    "<span class="attribute">pinned</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">    "<span class="attribute">department</span>": <span class="value"><span class="string">"ä¼æ¥­ç®¡ç†å­¸ç³»"</span></span>,</span><br><span class="line">    "<span class="attribute">replyId</span>": <span class="value"><span class="literal">null</span></span>,</span><br><span class="line">    "<span class="attribute">gender</span>": <span class="value"><span class="string">"M"</span></span>,</span><br><span class="line">    "<span class="attribute">replyTitle</span>": <span class="value"><span class="literal">null</span></span><br><span class="line">  </span>&#125;, ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>æä¾›è±å¯Œçš„åƒæ•¸èª¿æ§ï¼Œè®“ä¹‹å¾Œçš„å°ˆæ¡ˆé–‹ç™¼æ›´ä¾¿åˆ©ï¼ˆä¹‹å¾Œçš„ <code>dcard-lumberjack</code> å°ˆæ¡ˆå¤§é‡ä½¿ç”¨æ­¤æ–¹æ³•çš„åƒæ•¸è¨­å®šï¼‰ã€‚</p>
<ul>
<li><code>num</code>: å–å¾—å¹¾ç¯‡çš„æ–‡ç« å¾Œè¨­è³‡è¨Š (metadata of post)ã€‚ / é è¨­: 30ç¯‡</li>
<li><code>sort</code>: <code>popular</code> / <code>new</code>ï¼Œæ±ºå®šç”¨ä»€éº¼æ’åºæ–¹æ³•æŸ¥è©¢ (sorted by)ï¼Œæœ€æ–°æˆ–æœ€ç†±é–€æ’åºã€‚ / é è¨­: <code>&#39;new&#39;</code></li>
<li><code>timebound</code>: <code>&#39;{ISO-8601 æ™‚é–“å­—ä¸²}&#39;</code>ï¼Œè‹¥ç”¨ <code>new</code> ä¾†æ’åºæŸ¥è©¢çš„è©±ï¼Œè¦æŸ¥è©¢åˆ°å¤šæ—©ã€‚ï¼ˆä½¿ç”¨ UTC æ™‚é–“ï¼Œä¾ç…§<a href="https://zh.wikipedia.org/wiki/ISO_8601" target="_blank" rel="external">ISO-8601</a>è¡¨ç¤ºæ³•è½‰æˆå­—ä¸²ï¼‰ / é è¨­: <code>&#39;&#39;</code>ï¼ˆç©ºå­—ä¸²ï¼‰</li>
<li><code>callback</code>: ä¸ç›´æ¥å›å‚³ metasï¼Œæœƒå…ˆå¥—ç”¨æ­¤å‡½å¼å†å›å‚³ <code>callback_function</code> çš„æœ€çµ‚å€¼ï¼Œå¯ç•¶ä½œä¸€ç¨® reducerï¼Œæ¸›å°‘è³‡æ–™è¤‡é›œåº¦ã€‚ / é è¨­: None<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">''' example scenarios '''</span></span><br><span class="line">forum = Forum(<span class="string">'studyabroad'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. å–å¾—çœ‹æ¿ç†±é–€ 500 ç¯‡            </span></span><br><span class="line">metas = forum.get_metas(num=<span class="number">500</span>, sort=<span class="string">'popular'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å–å¾—çœ‹æ¿è¿‘ 1000 ç¯‡ä¸­ï¼ŒlikeCount å¤ å¤šçš„</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> ä¿ç•™å¾ˆå¤šè®šçš„æ–‡ç« <span class="params">(metas)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [meta <span class="keyword">for</span> meta <span class="keyword">in</span> metas <span class="keyword">if</span> meta[<span class="string">'likeCount'</span>] &gt;= <span class="number">50</span>]</span><br><span class="line">metas = forum.get_metas(num=<span class="number">1000</span>, callback=ä¿ç•™å¾ˆå¤šè®šçš„æ–‡ç« )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å–å¾— ç„¡é™å¤šç¯‡ æ–‡ç« è³‡è¨Šï¼Œç›´åˆ°è©²æ¿ç„¡æ–‡ç« </span></span><br><span class="line">metas = forum.get_metas(num=forums.infinite_page)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. å–å¾—æ—¥æœŸåœ¨ æœ€è¿‘ä¸‰å€‹æœˆ çš„æ–‡ç« è³‡è¨Š</span></span><br><span class="line">boundary_date = datetime.datetime.utcnow() - datetime.timedelta(months=<span class="number">3</span>)</span><br><span class="line">metas = forum.get_metas(</span><br><span class="line">            num=forums.infinite_page, timebound=boundary_date.isoformat())</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="Forums_full_code"><a href="#Forums_full_code" class="headerlink" title="Forums full code"></a>Forums full code</h4><p>é€™é‚Šé™„ä¸Š <code>dcard/forums.py</code> éƒ¨åˆ†å¯¦ä½œç¨‹å¼ç¢¼ä»¥åŠè§£èªªã€‚</p>
<ul>
<li>ä¸€äº›å¸¸æ•¸å®šç¾©<ul>
<li><code>metas_per_page</code> æ˜¯ <code>Dcard</code> API çš„ spec</li>
<li>å¦å¤–é æ•¸éƒ½æ‡‰è©²æ˜¯å¤§æ–¼ç­‰æ–¼é›¶çš„æ•´æ•¸ï¼Œæ‰€ä»¥å°‡ <code>infinite_page</code> æ¨¡å¼å®šç‚ºå¸¸æ•¸ -1</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">""" forums.py """</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Forum</span>:</span></span><br><span class="line">    metas_per_page = <span class="number">30</span></span><br><span class="line">    infinite_page = -<span class="number">1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>é€™é‚Šå¯ä»¥çœ‹åˆ°å„é …åƒæ•¸çš„å¯¦éš›ä½¿ç”¨ç‹€æ³ï¼›å°¤å…¶æ˜¯ <code>callback</code> åƒæ•¸å¯¦éš›åœ¨ package è£¡çš„ä½¿ç”¨æ™‚æ©Ÿã€‚<br>ä¹Ÿå°±æ˜¯åœ¨å›å‚³çµæœä¹‹å‰ï¼Œå¦‚æœæœ‰å®šç¾© <code>callback</code> çš„è©±å°±å…ˆå‘¼å«ä¸¦å°‡ <code>callback</code>çš„çµæœä½œç‚ºæœ€çµ‚ <code>results</code> (@<code>Line#8</code>)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_metas</span><span class="params">(self, num=<span class="number">30</span>, sort=<span class="string">'new'</span>, before=None, timebound=None, callback=None)</span>:</span></span><br><span class="line">    logger.info(<span class="string">'&lt;%s&gt; é–‹å§‹å–å¾—çœ‹æ¿å…§æ–‡ç« è³‡è¨Š'</span>, self.name)</span><br><span class="line"></span><br><span class="line">    paged_metas = self.get_paged_metas(sort, num, before, timebound)</span><br><span class="line">    buff = flatten_lists(metas <span class="keyword">for</span> metas <span class="keyword">in</span> paged_metas)</span><br><span class="line"></span><br><span class="line">    results = callback(buff) <span class="keyword">if</span> callback <span class="keyword">else</span> buff</span><br><span class="line"></span><br><span class="line">    logger.info(<span class="string">'&lt;%s&gt; è³‡è¨Šè’é›†å®Œæˆï¼Œå…±%dç­†'</span>, self.name, len(buff))</span><br><span class="line">    <span class="keyword">return</span> results</span><br></pre></td></tr></table></figure>
<ul>
<li>é€™å€‹æ˜¯ <code>get_meta()</code> å¯¦éš›è² è²¬å„é …åˆ¤æ–·åŠè™•ç† API è³‡æ–™å›å‚³å›ä¾†çš„å¯¦éš› <code>generator</code>ã€‚<br>å…¶ä¸­æœ‰å¹¾å€‹å…§éƒ¨çš„ inner method:<ul>
<li><code>eager_for_metas()</code> + <code>get_single_page_metas()</code>: å‰è€…æ±ºå®šæ˜¯å¦è¦ç¹¼çºŒè¦è³‡æ–™ï¼Œå¾Œè€…æ˜¯è² è²¬é€å‡ºè«‹æ±‚çš„ generatorã€‚</li>
<li><code>filter_metas()</code>: éæ¿¾ä¸¦åƒ…ä¿ç•™éœ€è¦çš„è³‡æ–™ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_paged_metas</span><span class="params">(self, sort, num, before, timebound=<span class="string">''</span>)</span>:</span></span><br><span class="line">    params = &#123;<span class="string">'popular'</span>: sort == <span class="string">'popular'</span>, <span class="string">'before'</span>: before&#125;</span><br><span class="line">    pages = -(-num // self.metas_per_page)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">filter_metas</span><span class="params">(metas)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> num &gt;= <span class="number">0</span> <span class="keyword">and</span> page == pages:</span><br><span class="line">            metas = metas[:num - (pages - <span class="number">1</span>) * self.metas_per_page]</span><br><span class="line">        <span class="keyword">if</span> timebound:</span><br><span class="line">            metas = [m <span class="keyword">for</span> m <span class="keyword">in</span> metas <span class="keyword">if</span> m[<span class="string">'updatedAt'</span>] &gt; timebound]</span><br><span class="line">        <span class="keyword">return</span> metas</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">eager_for_metas</span><span class="params">(bundle)</span>:</span></span><br><span class="line">        page, metas = bundle</span><br><span class="line">        <span class="keyword">if</span> num &gt;= <span class="number">0</span> <span class="keyword">and</span> page == pages + <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        <span class="keyword">if</span> len(metas) == <span class="number">0</span>:</span><br><span class="line">            logger.warning(<span class="string">'[%s] å·²åˆ°æœ€æœ«é ï¼Œç¬¬%dé !'</span>, self.name, page)</span><br><span class="line">        <span class="keyword">return</span> len(metas) != <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_single_page_metas</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            <span class="keyword">yield</span> self.client.get_json(self.posts_meta_url, params=params)</span><br><span class="line"></span><br><span class="line">    paged_metas = zip(count(start=<span class="number">1</span>), get_single_page_metas())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> page, metas <span class="keyword">in</span> takewhile(eager_for_metas, paged_metas):</span><br><span class="line">        params[<span class="string">'before'</span>] = metas[-<span class="number">1</span>][<span class="string">'id'</span>]</span><br><span class="line">        metas = filter_metas(metas)</span><br><span class="line">        <span class="keyword">if</span> len(metas) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">yield</span> metas</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå°±æ˜¯è² è²¬è™•ç† <code>çœ‹æ¿ (Forums)</code> çš„ moduleã€‚</p>
<h3 id="u6587_u7AE0_u5167_u5BB9_u76F8_u95DC_u8CC7_u8A0A__28Post-layer_29"><a href="#u6587_u7AE0_u5167_u5BB9_u76F8_u95DC_u8CC7_u8A0A__28Post-layer_29" class="headerlink" title="æ–‡ç« å…§å®¹ç›¸é—œè³‡è¨Š (Post-layer)"></a>æ–‡ç« å…§å®¹ç›¸é—œè³‡è¨Š (Post-layer)</h3><ul>
<li><p>åœ¨ <code>Posts</code> ä¸­ä¸»åªæœ‰ä¸€å€‹å°å¤–ï¼ˆä½œç‚ºå¥—ä»¶æä¾›çµ¦å¤–éƒ¨å‘¼å«ï¼‰çš„æ–¹æ³•</p>
<ul>
<li><p>ä¸éä¸¦ä¸æ˜¯ç›´æ¥å‘¼å«ä½¿ç”¨ï¼Œä½¿ç”¨å‰å…ˆå¡«å…¥åƒæ•¸ï¼Œå¯ä»¥è‡ªå‹•åˆ¤åˆ¥å…©ç¨®æä¾›çš„è³‡è¨Š (<code>meta</code> æˆ– <code>id</code>) ä¾†å–å¾—æ–‡ç« å…§å®¹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">""" list of metas """</span></span><br><span class="line">metas = dcard.forum(<span class="string">'whysoserious'</span>).get()</span><br><span class="line"></span><br><span class="line"><span class="string">""" list of ids """</span></span><br><span class="line">ids = [meta[<span class="string">'id'</span>] <span class="keyword">for</span> meta <span class="keyword">in</span> metas]</span><br><span class="line"></span><br><span class="line">articles = dcard.posts(metas)</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">articles = dcard.posts(ids)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol>
<li><p><code>get(self, content=True, links=True, comments=True)</code>:</p>
<ul>
<li>ç”¨ä¾†å–å¾—æ–‡ç« è³‡æ–™ï¼Œè€Œä¸‰é …åƒæ•¸åˆ†åˆ¥ä»£è¡¨æ˜¯å¦è¦å–å¾—æ–‡ç« å…§å®¹ã€å¼•ç”¨é€£çµå’Œè©²ç¯‡æ–‡ç« çš„ç•™è¨€ã€‚</li>
<li><p>å…¶å¯¦ä½œåº•ä¸‹åˆåˆ†ç‚ºä¸‰å€‹éƒ¨åˆ†: <code>get_content</code>, <code>get_links</code>, <code>get_comments</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_content</span><span class="params">(self, post_ids)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        self.client.get(api.post_url_pattern.format(post_id=post_id))</span><br><span class="line">        <span class="keyword">for</span> post_id <span class="keyword">in</span> post_ids</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_links</span><span class="params">(self, post_ids)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        self.client.get(api.post_links_url_pattern.format(post_id=post_id))</span><br><span class="line">        <span class="keyword">for</span> post_id <span class="keyword">in</span> post_ids</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_comments</span><span class="params">(self, post_ids, post_metas)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        self.get_comments_parallel(meta[<span class="string">'id'</span>], meta[<span class="string">'commentCount'</span>])</span><br><span class="line">        <span class="keyword">for</span> meta <span class="keyword">in</span> post_metas</span><br><span class="line">    ) <span class="keyword">if</span> post_metas <span class="keyword">else</span> (</span><br><span class="line">        self.get_comments_serial(post_id)</span><br><span class="line">        <span class="keyword">for</span> post_id <span class="keyword">in</span> post_ids</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>get_content</code>, <code>get_links</code> å¾ˆå®¹æ˜“åšåˆ°å¹³è¡ŒåŒ– (parallel) æˆ–ä¸¦è¡Œ (concurrent) åŸ·è¡Œä¾†åŠ å¿«å–å¾—å¤§é‡æ–‡ç« çš„æ•ˆç‡ (throughput)ã€‚</p>
</li>
<li><p>æ¯”è¼ƒéº»ç…©çš„æ˜¯ <code>get_comments</code>ï¼Œå› ç‚ºå‰é¢æåˆ° <code>Posts</code> èƒ½åŒæ™‚åƒ <code>metas</code> å’Œ <code>ids</code> å…©ç¨®åƒæ•¸ï¼Œæ‰€ä»¥åœ¨å–å¾—ç•™è¨€ä¸Šåˆ†å…©ç¨®ç­–ç•¥ï¼š</p>
<ul>
<li>æä¾› <code>id</code> çš„æƒ…æ³ï¼šå°å¤šç¯‡åˆ†åˆ¥å¾ªåºå–å¾—æ–‡ç« ç•™è¨€ (<code>get_comments_serial</code>)</li>
<li>æä¾› <code>meta</code> çš„æƒ…æ³ï¼šå°å¤šç¯‡åˆ†åˆ¥ä¸¦è¡Œå–å¾—æ–‡ç« ç•™è¨€ (<code>get_comments_parallel</code>)<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_comments_serial</span><span class="params">(self, post_id)</span>:</span></span><br><span class="line">    comments_url = api.post_comments_url_pattern.format(post_id=post_id)</span><br><span class="line">    params = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen_cmts</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            <span class="keyword">yield</span> self.client.get_json(comments_url, params=params)</span><br><span class="line"></span><br><span class="line">    comments = []</span><br><span class="line">    <span class="keyword">for</span> cmts <span class="keyword">in</span> takewhile(<span class="keyword">lambda</span> x: len(x), gen_cmts()):</span><br><span class="line">        comments += cmts</span><br><span class="line">        params[<span class="string">'after'</span>] = cmts[-<span class="number">1</span>][<span class="string">'floor'</span>]</span><br><span class="line">    <span class="keyword">return</span> comments</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_comments_parallel</span><span class="params">(self, post_id, comments_count)</span>:</span></span><br><span class="line">    pages = -(-comments_count // self.comments_per_page)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        self.client.get(</span><br><span class="line">            api.post_comments_url_pattern.format(post_id=post_id),</span><br><span class="line">            params=&#123;<span class="string">'after'</span>: page * self.comments_per_page&#125;)</span><br><span class="line">        <span class="keyword">for</span> page <span class="keyword">in</span> range(pages)</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>è€Œ <code>dcard.posts(metas).get()</code> å›å‚³çš„æ˜¯ä¸€å€‹ <code>generator</code>ï¼Œè£¡é¢çš„è³‡è¨Šçµæ§‹é•·é€™æ¨£å­ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> article <span class="keyword">in</span> dcard.posts(metas).get():</span><br><span class="line">    print(artile)</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    "<span class="attribute">comments</span>": <span class="value">[</span><br><span class="line">    &#123;</span><br><span class="line">        "<span class="attribute">reportReason</span>": <span class="value"><span class="string">""</span></span>,</span><br><span class="line">        "<span class="attribute">school</span>": <span class="value"><span class="string">"é€¢ç”²å¤§å­¸"</span></span>,</span><br><span class="line">        "<span class="attribute">createdAt</span>": <span class="value"><span class="string">"2016-07-15T11:06:29.029Z"</span></span>,</span><br><span class="line">        "<span class="attribute">hidden</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">        "<span class="attribute">anonymous</span>": <span class="value"><span class="literal">true</span></span>,</span><br><span class="line">        "<span class="attribute">floor</span>": <span class="value"><span class="number">1</span></span>,</span><br><span class="line">        "<span class="attribute">updatedAt</span>": <span class="value"><span class="string">"2016-07-15T11:06:29.029Z"</span></span>,</span><br><span class="line">        "<span class="attribute">postId</span>": <span class="value"><span class="number">224362498</span></span>,</span><br><span class="line">        "<span class="attribute">likeCount</span>": <span class="value"><span class="number">0</span></span>,</span><br><span class="line">        "<span class="attribute">id</span>": <span class="value"><span class="string">"587c62b2-70be-4469-8f3a-641705606e54"</span></span>,</span><br><span class="line">        "<span class="attribute">host</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">        "<span class="attribute">content</span>": <span class="value"><span class="string">"ä½ éŒ¯äº†ï¼Œè‡‰å¾ˆé‡è¦ã€‚"</span></span>,</span><br><span class="line">        "<span class="attribute">gender</span>": <span class="value"><span class="string">"M"</span></span><br><span class="line">    </span>&#125;</span><br><span class="line">    ]</span>,</span><br><span class="line">    "<span class="attribute">links</span>": <span class="value">&#123;&#125;</span>,</span><br><span class="line">    "<span class="attribute">content</span>": <span class="value">&#123;</span><br><span class="line">        "<span class="attribute">tags</span>": <span class="value">[<span class="string">"å¡å‹"</span>,ã€€<span class="string">"ç•«ç´ "</span>,ã€€<span class="string">"ç™¾è¬"</span>,ã€€<span class="string">"å¹¾åè¬"</span>,ã€€<span class="string">"åŠ æ²¹å§"</span>]</span>,</span><br><span class="line">        "<span class="attribute">title</span>": <span class="value"><span class="string">"åŠ æ²¹å§ï¼å¡å‹å€‘"</span></span>,</span><br><span class="line">        "<span class="attribute">forumName</span>": <span class="value"><span class="string">"æœ‰è¶£"</span></span>,</span><br><span class="line">        "<span class="attribute">anonymousSchool</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">        "<span class="attribute">forumAlias</span>": <span class="value"><span class="string">"funny"</span></span>,</span><br><span class="line">        "<span class="attribute">createdAt</span>": <span class="value"><span class="string">"2016-07-15T11:04:12.795Z"</span></span>,</span><br><span class="line">        "<span class="attribute">replyTitle</span>": <span class="value"><span class="literal">null</span></span>,</span><br><span class="line">        "<span class="attribute">school</span>": <span class="value"><span class="string">"å‹¤ç›Šç§‘å¤§"</span></span>,</span><br><span class="line">        "<span class="attribute">content</span>": <span class="value"><span class="string">"å›æƒ³é€™å¹¾å¹´ï¼Œæˆ‘åšç›¡ç¤¾æœƒçš„è¾›é…¸è‰±é›£\nå¾ä¸€é–‹å§‹\nä»€éº¼éƒ½æ²’æœ‰åˆ°äº†å¹¾åè¬\nå†å¾å¹¾åè¬åˆ°ç™¾è¬\nç™¾è¬å†åˆ°åƒè¬\næœ€å¾Œåƒè¬åˆ°ç¾åœ¨çš„2100è¬\næˆ‘ä¸æ˜¯è¦ç‚«è€€\nåªæ˜¯æƒ³é€éè‡ªå·±çš„ç¶“æ­·å‘Šè¨´å¤§å®¶\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\næ‰‹æ©Ÿç•«ç´ è¶Šé«˜ï¼Œç…§ç‰‡è¶Šå¥½çœ‹ğŸ˜ğŸ˜ğŸ˜"</span></span>,</span><br><span class="line">        "<span class="attribute">commentCount</span>": <span class="value"><span class="number">1</span></span>,</span><br><span class="line">        "<span class="attribute">updatedAt</span>": <span class="value"><span class="string">"2016-07-15T11:06:45.664Z"</span></span>,</span><br><span class="line">        "<span class="attribute">forumId</span>": <span class="value"><span class="string">"a1aaa6e6-2594-4968-b7dc-e1b14bea96f4"</span></span>,</span><br><span class="line">        "<span class="attribute">likeCount</span>": <span class="value"><span class="number">2</span></span>,</span><br><span class="line">        "<span class="attribute">excerpt</span>": <span class="value"><span class="string">"å›æƒ³é€™å¹¾å¹´ï¼Œæˆ‘åšç›¡ç¤¾æœƒçš„è¾›é…¸è‰±é›£\nå¾ä¸€é–‹å§‹\nä»€éº¼éƒ½æ²’æœ‰åˆ°äº†å¹¾åè¬\nå†å¾å¹¾åè¬åˆ°ç™¾è¬\nç™¾è¬å†åˆ°åƒè¬\næœ€å¾Œåƒè¬åˆ°ç¾åœ¨çš„2100è¬\næˆ‘ä¸æ˜¯è¦ç‚«è€€\nåªæ˜¯æƒ³é€éè‡ªå·±çš„ç¶“æ­·å‘Šè¨´å¤§å®¶\n.\n.\n.\n.\n.\n.\n.\n."</span></span>,</span><br><span class="line">        "<span class="attribute">id</span>": <span class="value"><span class="number">224362498</span></span>,</span><br><span class="line">        "<span class="attribute">anonymousDepartment</span>": <span class="value"><span class="literal">true</span></span>,</span><br><span class="line">        "<span class="attribute">pinned</span>": <span class="value"><span class="literal">false</span></span>,</span><br><span class="line">        "<span class="attribute">replyId</span>": <span class="value"><span class="literal">null</span></span>,</span><br><span class="line">        "<span class="attribute">gender</span>": <span class="value"><span class="string">"M"</span></span>,</span><br><span class="line">        "<span class="attribute">deletedAt</span>": <span class="value"><span class="literal">null</span></span><br><span class="line">    </span>&#125;</span><br><span class="line"></span>&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<p>ä»¥ä¸Šå°±æ˜¯è² è²¬è™•ç† æ–‡ç«  (Posts) çš„ moduleã€‚</p>
<h3 id="u4F7F_u7528_u7BC4_u4F8B"><a href="#u4F7F_u7528_u7BC4_u4F8B" class="headerlink" title="ä½¿ç”¨ç¯„ä¾‹"></a>ä½¿ç”¨ç¯„ä¾‹</h3><p>èªªé‚£éº¼å¤šï¼Œä¸å¦‚å¯¦éš›çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ã€‚</p>
<ul>
<li>ç¯„ä¾‹æƒ…å¢ƒ 1: æƒ³è¦çœ‹çœ‹æœ‰è¶£ç‰ˆä¸€å¤©è£¡å¤ ç†±é–€ (likes æ•¸å¤šæ–¼ 100) çš„æ–‡ç« è£¡ï¼Œç•™è¨€çš„éƒ½æ˜¯ä»€éº¼å­¸æ ¡çš„äººã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="keyword">from</span> dcard <span class="keyword">import</span> Dcard</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dcard = Dcard()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨ä¾†å­˜æ”¾æƒ³å¾—åˆ°çš„è³‡è¨Š =&gt; &#123;'æŸæŸå­¸æ ¡': $&#123;å¤šå°‘ç•™è¨€æ•¸&#125;, ...&#125;</span></span><br><span class="line">analyzed_result = defaultdict(<span class="keyword">lambda</span>: <span class="number">0</span>)</span><br><span class="line"><span class="comment"># å¿…é ˆä½¿ç”¨ UTC æ™‚é–“ï¼Œç„¶å¾Œè¨‚å®šæœå°‹ç¯„åœæ˜¯ä¸€å¤©å…§</span></span><br><span class="line">target_date = datetime.datetime.utcnow() - datetime.timedelta(days=<span class="number">1</span>) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">filter_hot</span><span class="params">(metas)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [meta <span class="keyword">for</span> meta <span class="keyword">in</span> metas <span class="keyword">if</span> meta[<span class="string">'likeCount'</span>] &gt;= <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line">metas = dcard.forums(<span class="string">'funny'</span>).get_metas(</span><br><span class="line">            num=dcard.forums.infinite_page,  <span class="comment"># å› ç‚ºæ²’æœ‰æ˜ç¢ºæ•¸é‡ç›®æ¨™ (ç”±æ™‚é–“åšç‚ºé™åˆ¶æ¢ä»¶)ï¼Œæ­¤é …è¨­ç‚ºç„¡é™å¤§</span></span><br><span class="line">            timebound=target_date.isoformat(),  <span class="comment"># å¿…é ˆå°‡æ™‚é–“è½‰æˆ ISO-8601 åˆ¶çš„æ™‚é–“å­—ä¸²</span></span><br><span class="line">            callback=filter_hot  <span class="comment"># æ ¹æ“šæ¢ä»¶å¯«å€‹éæ¿¾å™¨</span></span><br><span class="line">        )</span><br><span class="line">print(<span class="string">'Collect %d metas'</span> % len(metas))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å› ç‚ºé€™è£¡æˆ‘å€‘åªé—œæ³¨ç•™è¨€è³‡è¨Šï¼Œå…¶ä»–å…©å€‹è³‡è¨Šå¯ä»¥ç•¥é</span></span><br><span class="line">articles = dcard.posts(metas).get(content=<span class="keyword">False</span>, links=<span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†æ</span></span><br><span class="line"><span class="keyword">for</span> article <span class="keyword">in</span> articles.result():</span><br><span class="line">    <span class="keyword">for</span> comment <span class="keyword">in</span> article[<span class="string">'comments'</span>]:</span><br><span class="line">        analyzed_result[comment.get(<span class="string">'school'</span>)] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">print(analyzed_result)</span><br></pre></td></tr></table></figure>
<ul>
<li>çµæœå¯èƒ½é•·å¾—åƒé€™æ¨£ï¼Œ</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Collect <span class="number">355</span> metas</span><br><span class="line"></span><br><span class="line">defaultdict(&lt;function &lt;<span class="keyword">lambda</span>&gt; at <span class="number">0x0</span>xxxxxxxxxxxxxxx&gt;, &#123;</span><br><span class="line">    <span class="string">'é‡‘é–€å¤§å­¸'</span>: <span class="number">35</span>, <span class="string">'æ±æµ·å¤§å­¸'</span>: <span class="number">71</span>, <span class="string">'åœ‹ç«‹æˆåŠŸå¤§å­¸'</span>: <span class="number">4</span>, <span class="string">'å¤§åŒå¤§å­¸'</span>: <span class="number">9</span>, <span class="string">'ç„å¥˜å¤§å­¸'</span>: <span class="number">29</span>,</span><br><span class="line">    <span class="string">'è–ç´„ç¿°ç§‘æŠ€å¤§å­¸'</span>: <span class="number">3</span>, <span class="string">'åœ‹ç«‹é«˜é›„æ‡‰ç”¨ç§‘æŠ€å¤§å­¸'</span>: <span class="number">3</span>, <span class="string">'æ¸…è¯å¤§å­¸'</span>: <span class="number">8</span>, <span class="string">'åœ‹ç«‹è‡ºåŒ—ç§‘æŠ€å¤§å­¸'</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="string">'åœ‹ç«‹é«˜é›„å¸«ç¯„å¤§å­¸'</span>: <span class="number">3</span>, <span class="string">'åœ‹ç«‹è‡ºç£è—è¡“å¤§å­¸'</span>: <span class="number">10</span>, ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åŒæ¨£çš„æ‡‰ç”¨ï¼Œæˆ–è¨±ä¹Ÿå¯ä»¥åˆ° whysoserious çœ‹çœ‹å“ªå€‹å­¸æ ¡æœ€æ„›ç™¼è²»é›¯ XDD</p>
<ul>
<li>ç¯„ä¾‹æƒ…å¢ƒ 2: æƒ³æŠ“æ”å½±ç‰ˆä¸Šæœ€è¿‘ç™¾ç¯‡ä¸” likes å¤ é«˜æ–‡ç« å…§æ–‡è£¡çš„â€åœ–ç‰‡â€å€‘ï¼</li>
</ul>
<p><strong>ç¨‹å¼ä½œæ³•</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dcard <span class="keyword">import</span> Dcard</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">filter_hot</span><span class="params">(metas)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [meta <span class="keyword">for</span> meta <span class="keyword">in</span> metas <span class="keyword">if</span> meta[<span class="string">'likeCount'</span>] &gt;= <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line">dcard = Dcard()</span><br><span class="line"><span class="comment"># å…ˆæŠ“ç™¾ç¯‡ meta å‡ºä¾†ï¼Œç„¶å¾Œéæ¿¾å‡ºç†±é–€çš„</span></span><br><span class="line">metas = dcard.forums(<span class="string">'photography'</span>).get_metas(num=<span class="number">100</span>, callback=filter_hot)</span><br><span class="line"><span class="comment"># å› ç‚ºåªæƒ³è¦åˆ†æå…§æ–‡è£¡çš„åœ–ç‰‡ è‹¥æ˜¯é€£ç•™è¨€å›å¾©çš„åœ–éƒ½è¦æ†¶èµ·åˆ†æï¼Œé‚£å°±å°‡ comments=False æ‹¿æ‰</span></span><br><span class="line">posts = dcard.posts(metas).get(comments=<span class="keyword">False</span>, links=<span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line">resources = posts.parse_resources()  <span class="comment"># é–‹å§‹åˆ†ææ–‡ç« å…§çš„åœ–ç‰‡</span></span><br><span class="line">fin, fails = posts.download(resources)  <span class="comment"># ä¸‹è¼‰åˆ†æå‡ºä¾†çš„åœ–ç‰‡</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'æˆåŠŸä¸‹è¼‰ %d é …ï¼'</span> % fin <span class="keyword">if</span> len(fails) == <span class="number">0</span> <span class="keyword">else</span> <span class="string">'å‡ºäº†é»éŒ¯ä¸‹è¼‰ä¸å®Œå…¨å–”'</span>)</span><br></pre></td></tr></table></figure>
<p><strong>æŒ‡ä»¤åšæ³•</strong></p>
<p>æœ¬ package æä¾› <code>command-line</code> å¼ä½¿ç”¨æ–¹æ³•å”·~ æ–¹ä¾¿åˆç°¡å–®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dcard download <span class="operator">-f</span> photography -n <span class="number">100</span> -likes <span class="number">100</span></span><br></pre></td></tr></table></figure>
<ul>
<li>çµæœï¼š</li>
</ul>
<img src="/2016/dcard-spider-python-package/snapshot.png" alt="åŸ·è¡Œæˆæœ" title="åŸ·è¡Œæˆæœ">
<p>ä»¥ä¸Šå°±æ˜¯æˆ‘çš„ dcard-spider æ¶æ§‹åˆ†äº«ã€‚è‹¥æœ‰ç™¼ç¾ bugs æˆ– åŠŸèƒ½å»ºè­°æ­¡è¿è‡³ Github issues ç•™è¨€~</p>
<p>Salas / 2016.08</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸Šæ¬¡è«‡åˆ°äº† Dcard ç¾åœ¨å®˜æ–¹å¯¦éš› production ä¸­ä½¿ç”¨çš„ API URL è¦å‰‡ï¼Œä¸¦ä¸”æ’°å¯«äº†ç°¡å–®çš„ Python scripts ä¾†å–å¾—å°éƒ¨åˆ†è³‡æ–™ã€‚&lt;br&gt;è€Œé€™æ¨£çš„æˆæœé©åˆç”¨ä¾†åšå°è¦æ¨¡çš„å¾ŒçºŒæ‡‰ç”¨ï¼Œä¾‹å¦‚ç‰¹å®šç‰ˆçš„ç•¶æ—¥æˆ–ç•¶æœˆæ–‡ç« åˆ†æç­‰ç­‰ï¼›ç„¶è€Œè‹¥æ˜¯è¦æ‹¿ä¸‹å…¨ç«™çš„è³‡æ–™ï¼Œé‚£éº¼æˆ‘å€‘ä¸Šæ¬¡çš„ç¨‹å¼ç¯„ä¾‹æœ¬èº«å¿…é ˆè¦æ”¹å–„ä¾†è®“å¾ŒçºŒæ–¹ä¾¿æ“´å……ï¼ˆå…¶å¯¦æ˜¯ä¸Šæ¬¡ç¨‹å¼è¶•å·¥å¯«å¤ªé†œï¼Œç”Ÿç†ä¸Šä¸èƒ½æ¥å—(?) å®Œå…¨æ²’æœ‰æƒ³è¦ç›´æ¥æ²¿ç”¨çš„å¿µé ­ XDï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é‚£éº¼æ¥ä¸‹ä¾†çš„æ¦‚å¿µå°±æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æˆ‘è¦ä¸€éš»å¤§èœ˜è››ï¼ˆæ¯”èµ· crawlerï¼Œæˆ‘é¸æ“‡ Spiderï¼è½èµ·ä¾†å°±æ¯”è¼ƒçŒ›ï¼Œä»¥ä¸‹éƒ½ç”¨ spider ç¨±å‘¼é€™éš»ç¶²è·¯çˆ¬èŸ² é¡†é¡†ï¼‰&lt;/p&gt;
&lt;img src=&quot;/2016/dcard-spider-python-package/Giant_spider_strikes.jpg&quot; alt=&quot;[Giant spider strikes from wiki]&quot; title=&quot;[Giant spider strikes from wiki]&quot;&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é‚£é™¤äº†æ ¸å¿ƒçš„è»€å¹¹ä¹‹å¤–éœ€è¦å…ˆé€ å…«éš» &lt;del&gt;èŸ¹&lt;/del&gt; è…³å•Šï¼ä¸Šæ¬¡é‚£å€‹å“è³ªï¼ï¼ï¼å¯æ˜¯æ’ä¸èµ·é€™éš»å·¨å‹èœ˜è››çš„&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¸çŸ¥æ‰€äº‘ï¼Œç¸½ä¹‹å°±æ˜¯æŠŠä¹‹å‰çš„æ¦‚å¿µæ‰“é€ æˆå¥½ç”¨çš„è…¿å°±å°äº†ã€‚ä¹‹å¾Œèœ˜è››å¥½è¾¦äº‹ï¼&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æˆæœå·²ç¶“ç™¼å¸ƒåœ¨ &lt;a href=&quot;https://pypi.python.org/pypi/dcard-spider&quot;&gt;PyPI&lt;/a&gt; ä»¥åŠ &lt;a href=&quot;https://github.com/leVirve/dcard-spider&quot;&gt;Github&lt;/a&gt; ä¸Šäº†ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Python" scheme="https://levirve.github.io/tags/Python/"/>
    
      <category term="Spider" scheme="https://levirve.github.io/tags/Spider/"/>
    
  </entry>
  
  <entry>
    <title>Dccard çˆ¬èŸ²ï¼Œé€éå®˜æ–¹API</title>
    <link href="https://levirve.github.io/2016/Dccard-crawler/"/>
    <id>https://levirve.github.io/2016/Dccard-crawler/</id>
    <published>2016-07-12T13:55:44.000Z</published>
    <updated>2016-07-30T09:25:18.136Z</updated>
    
    <content type="html"><![CDATA[<p>åŸæœ¬çˆ¬èŸ²ä½¿ç”¨ PTT ä½œç‚ºç·´ç¿’æ¨™çš„ï¼Œä½†æ˜¯å¹´è¼•äººå¥½åƒå·²ç¶“ä¸æµè¡Œç”¨é€™å€‹(?)ï¼Œè€Œä¸”å¦ä¸€æ–¹é¢ä¹Ÿä¸æƒ³åœ¨é é¢ parsing ä¸ŠèŠ±å¤ªå¤šåŠŸå¤«ã€‚<br>é€™æ¬¡æƒ³è¦ç·´ç¿’çš„æ±è¥¿æ˜¯çˆ¬èŸ²æ¶æ§‹ä»¥åŠå…¶ä»–å¾ŒçºŒæ‡‰ç”¨ï¼Œè€Œä¸å†æ‹˜æ³¥è™•ç†è³‡æ–™æœ¬èº«ï¼›æ‰€ä»¥é¸æ“‡äº†èˆ‡ PTT ç›¸ä¼¼æ€§è³ªä¸”æ“æœ‰ API çš„ Dcard ä½œç‚ºå¯¦é©—ç›®æ¨™ã€‚</p>
<a id="more"></a>
<h1 id="u7DB2_u7AD9_API__u898F_u5247"><a href="#u7DB2_u7AD9_API__u898F_u5247" class="headerlink" title="ç¶²ç«™ API è¦å‰‡"></a>ç¶²ç«™ API è¦å‰‡</h1><p>ç¶²è·¯ä¸Šæµå‚³å¤šç¨® <code>Dcard</code> API èˆ‡å„å¼ API wrapper ç¨‹å¼å¥—ä»¶ï¼Œä¸éç¶²ç«™æœ¬èº«ä¼¼ä¹åœ¨æ”¹ç‰ˆä¸­ (çœ‹èµ·ä¾†æ˜¯ç‚ºäº†å› æ‡‰å‰ç«¯çš„æŠ€è¡“ stack æ”¹è®Šï¼Œè½‰æ›è‡³ React.js ç’°å¢ƒé–‹ç™¼å§) è®Šå¾—å¤§é‡ä½¿ç”¨éåŒæ­¥è«‹æ±‚ (ajax) ä¾†ç²å¾—è³‡æ–™ä¸¦ç¹ªè£½ç•«é¢ã€‚æ‰€ä»¥å‰è¿°çš„é‚£äº›å¥—ä»¶åŠæ—©æœŸå…¬é–‹çš„ API å¹¾ä¹é€šé€šå¤±æ•ˆã€‚</p>
<p>ä¸éé‡æ–°åˆ°ç¶²ç«™ä¸Šé€éé–‹ç™¼è€…å·¥å…·é‡æ–°è§€å¯Ÿä¾¿èƒ½ç²å¾—ä¸€äº›è¦å‰‡ï¼Œé‡æ–°çµ„åˆå‡ºç¶²ç«™å¯¦éš›åœ¨ä½¿ç”¨çš„æ–°ç‰ˆ APIã€‚ç•¶ç„¶é€™äº›è³‡è¨Šæˆ–è¨±éš¨è‘—ç¶²ç«™æ”¹è®Šæœƒå¤±æ•ˆä¹Ÿä¸ä¸€å®š (å°¤å…¶æ˜¯ <code>_api</code> é€™æ¨£å­çš„å‘½åï¼Œæ˜é¡¯æ˜¯éåº¦ç”¢ç‰©çš„æ„Ÿè¦º)</p>
<p><strong>API root URL</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://dcard.tw/_api/</span><br></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th>API</th>
<th>URL</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>çœ‹æ¿è³‡è¨Š(meta)</strong></td>
<td><code>http://dcard.tw/_api/forums</code></td>
</tr>
<tr>
<td><strong>æ–‡ç« è³‡è¨Š(meta)</strong></td>
<td><code>http://dcard.tw/_api/forums/{çœ‹æ¿åç¨±}/posts</code></td>
</tr>
<tr>
<td><strong>æ–‡ç« å…§æ–‡</strong></td>
<td><code>http://dcard.tw/_api/posts/{æ–‡ç« ç·¨è™Ÿ}</code></td>
</tr>
<tr>
<td><strong>æ–‡ç« å…§å¼•ç”¨é€£çµ</strong></td>
<td><code>http://dcard.tw/_api/posts/{æ–‡ç« ç·¨è™Ÿ}/links</code></td>
</tr>
<tr>
<td><strong>æ–‡ç« å…§ç•™è¨€</strong></td>
<td><code>http://dcard.tw/_api/posts/{æ–‡ç« ç·¨è™Ÿ}/comments</code></td>
</tr>
</tbody>
</table>
<p>ï¼Š<code>æ–‡ç« è³‡è¨Š(meta)</code> èˆ‡ <code>æ–‡ç« å…§ç•™è¨€</code> é è¨­ä½¿ç”¨ç†±é–€åº¦ (popularity) ä½œç‚ºæ’åºï¼Œè€Œä¸”ä¸€æ¬¡è«‹æ±‚ (request) ä¸­åªå›æ‡‰ <code>30 ç­†</code>ã€‚</p>
<ul>
<li>æƒ³è¦è®“é€™å…©é …ä½¿ç”¨ <code>æ™‚é–“</code> æ’åºï¼Œå¯åœ¨ <code>GET</code> åƒæ•¸ä¸­åŠ å…¥ <code>popular=false</code></li>
<li>æ¬²å–å¾—æ›´å¤šçš„ <code>æ–‡ç« è³‡è¨Š(meta)</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>before={æŸæ–‡ç« ç·¨è™Ÿ}</code>ä¾†ç²å¾—æ—©æ–¼ #{æŸæ–‡ç« ç·¨è™Ÿ} çš„å¦å¤– <code>30 ç­†</code> è³‡è¨Šã€‚</li>
<li>æ¬²å–å¾—æ›´å¤šçš„ <code>æ–‡ç« å…§ç•™è¨€</code>ï¼Œå¯ä»¥ä½¿ç”¨ <code>after={æŸæ¨“å±¤}</code>  ä¾†ç²å¾—å¤§æ–¼ #{æŸæ¨“å±¤} çš„å¦å¤– <code>30 ç­†</code> ç•™è¨€ã€‚</li>
</ul>
<h1 id="u958B_u59CB_u5BEB_u7C21_u6613_u722C_u87F2"><a href="#u958B_u59CB_u5BEB_u7C21_u6613_u722C_u87F2" class="headerlink" title="é–‹å§‹å¯«ç°¡æ˜“çˆ¬èŸ²"></a>é–‹å§‹å¯«ç°¡æ˜“çˆ¬èŸ²</h1><p>é¦–å…ˆå®šç¾©å¥½å‰›å‰›æåˆ°çš„åŸºæœ¬ URL è³‡è¨Š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dcard</span>:</span></span><br><span class="line"></span><br><span class="line">    API_ROOT = <span class="string">'http://dcard.tw/_api'</span></span><br><span class="line">    FORUMS = <span class="string">'forums'</span></span><br><span class="line">    POSTS = <span class="string">'posts'</span></span><br></pre></td></tr></table></figure>
<p>ä»¥åŠä¸€äº›åŸºæœ¬åŠŸèƒ½ @(utils.py)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># utils.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(url, verbose=False, **kwargs)</span>:</span></span><br><span class="line">    response = requests.get(url, **kwargs)</span><br><span class="line">    <span class="keyword">if</span> verbose:</span><br><span class="line">        logging.info(response.url)</span><br><span class="line">    <span class="keyword">return</span> response.json()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">filter_general</span><span class="params">(forums)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> forum <span class="keyword">in</span> forums:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> forum[<span class="string">'isSchool'</span>]:</span><br><span class="line">            <span class="keyword">yield</span> forum</span><br></pre></td></tr></table></figure>
<p>Step1. æ›¿ class <code>Dcard</code> æ–°å¢ methodï¼Œå–å¾—æ‰€æœ‰çœ‹æ¿è³‡è¨Š (metadata)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="decorator">@staticmethod</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_forums</span><span class="params">(**kwargs)</span>:</span></span><br><span class="line">    url = <span class="string">'&#123;api_root&#125;/&#123;api_forums&#125;'</span>.format(</span><br><span class="line">        api_root=Dcard.API_ROOT, api_forums=Dcard.FORUMS)</span><br><span class="line">    forums = get(url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> kwargs.get(<span class="string">'no_school'</span>):</span><br><span class="line">        <span class="keyword">return</span> [forum <span class="keyword">for</span> forum <span class="keyword">in</span> filter_general(forums)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> forums</span><br></pre></td></tr></table></figure>
<p>åƒæ•¸ä¸­åŠ å…¥ <code>no_school</code> ä¾†æ§åˆ¶æ˜¯å¦éæ¿¾æ‰å­¸æ ¡çœ‹æ¿ã€‚ä¹‹å¾Œæƒ³åšçš„åˆ†ææœƒè‘—é‡æ–¼æ¯”è¼ƒç†±é–€çš„ä¸€èˆ¬æ€§çœ‹æ¿ï¼Œæ‰€ä»¥é€™é‚Šåšå€‹é–‹é—œæ±ºå®šæ˜¯å¦å»æ‰é€™äº›ç‰¹å®šçœ‹æ¿ã€‚</p>
<p>Step2. æ›¿ class <code>Dcard</code> æ–°å¢ methodï¼Œå–å¾—çœ‹æ¿å…§æ–‡ç« è³‡è¨Š (metadata)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="decorator">@staticmethod</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_post_metas</span><span class="params">(forum, params)</span>:</span></span><br><span class="line">    url = <span class="string">'&#123;api_root&#125;/&#123;api_forums&#125;/&#123;forum&#125;/&#123;api_posts&#125;'</span>.format(</span><br><span class="line">        api_root=Dcard.API_ROOT,</span><br><span class="line">        api_forums=Dcard.FORUMS,</span><br><span class="line">        api_posts=Dcard.POSTS,</span><br><span class="line">        forum=forum</span><br><span class="line">    )</span><br><span class="line">    article_metas = get(url, params=params)</span><br><span class="line">    <span class="keyword">return</span> article_metas</span><br><span class="line"></span><br><span class="line"><span class="decorator">@staticmethod</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_post_ids</span><span class="params">(forum, pages=<span class="number">3</span>)</span>:</span></span><br><span class="line">    <span class="string">''' </span><br><span class="line">        ç‚ºäº†ä¸€æ¬¡å–çš„æ›´å¤šé çš„æ–‡ç«  (å¯ä»¥æŠŠä¸€æ¬¡ request å–å¾— 30 ç­†ï¼Œè¦–ä½œå–å¾—ä¸€é )</span><br><span class="line">        ä½¿ç”¨æ­¤ method å°‡ `get_post_metas` åšåŒ…è£ï¼Œæä¾›ä¸€æ¬¡æŠ“å–å¤šé æ–‡ç« è³‡è¨Šï¼Œ</span><br><span class="line">        ä¸”é€šå¸¸æ˜¯ç‚ºäº†ä¹‹å¾Œç”¨é€”è€ŒæŠ“å– &#123;æ–‡ç« ç·¨è™Ÿ&#125;ã€‚</span><br><span class="line">    '''</span></span><br><span class="line">    params = &#123;<span class="string">'popular'</span>: <span class="keyword">False</span>&#125;</span><br><span class="line">    ids = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(pages):</span><br><span class="line">        metas = Dcard.get_post_metas(forum, params)</span><br><span class="line">        ids += [e[<span class="string">'id'</span>] <span class="keyword">for</span> e <span class="keyword">in</span> metas]</span><br><span class="line">        params[<span class="string">'before'</span>] = ids[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> ids</span><br></pre></td></tr></table></figure>
<p>Step3. æœ€çµ‚çš„é‡é»ï¼Œå–å¾—å–®ç¯‡æ–‡ç« å…§çš„æ‰€æœ‰è³‡è¨Šï¼Œåˆ†ç‚ºï¼šå…§æ–‡ã€å¼•ç”¨é€£çµã€ç•™è¨€ä¸‰å€‹éƒ¨åˆ†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="decorator">@staticmethod</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_post_content</span><span class="params">(post_meta)</span>:</span></span><br><span class="line">    post_url = <span class="string">'&#123;api_root&#125;/&#123;api_posts&#125;/&#123;post_id&#125;'</span>.format(</span><br><span class="line">        api_root=Dcard.API_ROOT,</span><br><span class="line">        api_posts=Dcard.POSTS,</span><br><span class="line">        post_id=post_meta[<span class="string">'id'</span>]</span><br><span class="line">    )</span><br><span class="line">    links_url = <span class="string">'&#123;post_url&#125;/links'</span>.format(post_url=post_url)</span><br><span class="line">    comments_url = <span class="string">'&#123;post_url&#125;/comments'</span>.format(post_url=post_url)</span><br><span class="line"></span><br><span class="line">    params = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    content = get(post_url)</span><br><span class="line">    links = get(links_url)</span><br><span class="line">    comments = []</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        _comments = get(comments_url, params=params, verbose=<span class="keyword">True</span>)</span><br><span class="line">        <span class="keyword">if</span> len(_comments) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        comments += _comments</span><br><span class="line">        params[<span class="string">'after'</span>] = comments[-<span class="number">1</span>][<span class="string">'floor'</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">'content'</span>: content,</span><br><span class="line">        <span class="string">'links'</span>: links,</span><br><span class="line">        <span class="string">'comments'</span>: comments</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>é€é Dcard <code>ç¾æ­£å·å·ä½¿ç”¨ä¸­</code> çš„å®˜æ–¹ APIï¼Œå®Œæˆäº†æˆ‘å€‘çš„åŸºæœ¬çˆ¬èŸ²ã€‚</p>
<p>*<br>Salas</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åŸæœ¬çˆ¬èŸ²ä½¿ç”¨ PTT ä½œç‚ºç·´ç¿’æ¨™çš„ï¼Œä½†æ˜¯å¹´è¼•äººå¥½åƒå·²ç¶“ä¸æµè¡Œç”¨é€™å€‹(?)ï¼Œè€Œä¸”å¦ä¸€æ–¹é¢ä¹Ÿä¸æƒ³åœ¨é é¢ parsing ä¸ŠèŠ±å¤ªå¤šåŠŸå¤«ã€‚&lt;br&gt;é€™æ¬¡æƒ³è¦ç·´ç¿’çš„æ±è¥¿æ˜¯çˆ¬èŸ²æ¶æ§‹ä»¥åŠå…¶ä»–å¾ŒçºŒæ‡‰ç”¨ï¼Œè€Œä¸å†æ‹˜æ³¥è™•ç†è³‡æ–™æœ¬èº«ï¼›æ‰€ä»¥é¸æ“‡äº†èˆ‡ PTT ç›¸ä¼¼æ€§è³ªä¸”æ“æœ‰ API çš„ Dcard ä½œç‚ºå¯¦é©—ç›®æ¨™ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Python" scheme="https://levirve.github.io/tags/Python/"/>
    
      <category term="Spider" scheme="https://levirve.github.io/tags/Spider/"/>
    
  </entry>
  
  <entry>
    <title>ç¶²è·¯çˆ¬èŸ² Crawler Tutorial - (1) ç°¡ä»‹</title>
    <link href="https://levirve.github.io/2016/%E7%88%AC%E8%9F%B2/"/>
    <id>https://levirve.github.io/2016/çˆ¬èŸ²/</id>
    <published>2016-02-09T14:52:00.000Z</published>
    <updated>2016-02-12T12:47:15.832Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://images2.static-bluray.com/reviews/3695_1.jpg" alt="The Social Network å ´æ™¯ @www.blu-ray.com"><br><a id="more"></a></p>
<h1 id="u79D1_u666E_u77E5_u8B58"><a href="#u79D1_u666E_u77E5_u8B58" class="headerlink" title="ç§‘æ™®çŸ¥è­˜"></a>ç§‘æ™®çŸ¥è­˜</h1><p>å…ˆä¸å¤šåšè§£é‡‹ç›´æ¥çœ‹çœ‹ï¼ŒWiki æ€éº¼èªª: <a href="https://zh.wikipedia.org/wiki/%E7%B6%B2%E8%B7%AF%E8%9C%98%E8%9B%9B" target="_blank" rel="external">ç¶²è·¯çˆ¬èŸ²</a></p>
<blockquote>
<p>æ˜¯ä¸€ç¨®ã€Œè‡ªå‹•åŒ–ç€è¦½ç¶²è·¯ã€çš„ç¨‹å¼ï¼Œæˆ–è€…èªªæ˜¯ä¸€ç¨®ç¶²è·¯æ©Ÿå™¨äººã€‚è¢«ç”¨æ–¼è‡ªå‹•æ¡é›†é é¢å…§å®¹ï¼Œä»¥ä¾›åšé€²ä¸€æ­¥è™•ç†ï¼ˆåˆ†ææ•´ç†ä¸‹è¼‰çš„é é¢ï¼‰ï¼Œè®“ä½¿ç”¨è€…èƒ½æ›´å¿«å–å¾—éœ€è¦çš„è³‡è¨Šã€‚</p>
</blockquote>
<h1 id="u6B63_u6587"><a href="#u6B63_u6587" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><p>ç‚ºä»€éº¼é¦–åœ–è¦æ”¾ <em>The Social Network</em> ä¸­çš„å ´æ™¯å‘¢ï¼Ÿçœ‹éé€™éƒ¨é›»å½±çš„ä¸å¦¨è©¦è‘—å›æƒ³ä¸€ä¸‹ï¼Œç‰‡ä¸­ Mark Zuckerberg åœ¨å®¿èˆåšäº†ä»€éº¼äº‹ï¼Ÿ</p>
<p><img src="http://ecx.images-amazon.com/images/I/815a7Z-t0pL._SL1500_.jpg" alt="(Media from Amazon)"></p>
<blockquote>
<p>Mark: æˆ‘åœ¨æŠ“å­¸æ ¡ç¶²ç«™ä¸Šæ‰€æœ‰å¥³ç”Ÿçš„åœ–ç‰‡å•Šï¼<br>ç¶²ç«™ä¸€æ¬¡åªçµ¦çœ‹ä¸€å¼µï¼Œæ‰‹å‹•æŠ“ç´¯æ­»æˆ‘äº†<br>Mark: æ²’é—œä¿‚ï¼ŒHacker æœ‰è‡ªå·±çš„ç©æ³•ï¼Œlet me show you!</p>
</blockquote>
<p><img src="http://i.imgur.com/oeujxCW.png" alt="Mark: è®“ä½ ç§ç§æˆ‘çš„ Perl Script"></p>
<p>æ‰€ä»¥çˆ¬èŸ²è¦å¹¹å˜›ï¼Ÿ<del>ç•¶ç„¶æ˜¯æŠ“åœ–å•Š</del> æŠ“ä»»ä½•<strong>ä½ </strong>é—œæ³¨çš„è³‡æ–™ï¼</p>
<p>ç•¶ç„¶èªªåˆ°çˆ¬èŸ²ï¼Œä¸èƒ½ä¸æä»¥æ­¤å£¯å¤§è‡ªå·±äº‹æ¥­çš„ Google</p>
<p>Google çš„æ©Ÿå™¨äººï¼Œå¤©å¤©çˆ¬ä¸çœ ä¸ä¼‘çš„çˆ¬å…¨å¹´ç„¡ä¼‘ï¼Œé€™éº¼å¥½ç”¨çš„å·¥å…·äººä¸Šå“ªæ‰¾ï¼Ÿ</p>
<p>æ‰€ä»¥æœ¬ç³»åˆ—æ•™å­¸æ–‡å°±æ˜¯æ•™ä½ å¦‚ä½•å­¸æœƒ<del>è·ŸMarkä¸€æ¨£å¾ˆæœƒæŠ“åœ–</del>é¤Šéš»æœƒåœ¨ç¶²è·¯ä¸Šè·‘çš„çˆ¬èŸ²ï¼</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://images2.static-bluray.com/reviews/3695_1.jpg&quot; alt=&quot;The Social Network å ´æ™¯ @www.blu-ray.com&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Python" scheme="https://levirve.github.io/categories/Python/"/>
    
    
      <category term="Python" scheme="https://levirve.github.io/tags/Python/"/>
    
      <category term="çˆ¬èŸ²" scheme="https://levirve.github.io/tags/%E7%88%AC%E8%9F%B2/"/>
    
  </entry>
  
  <entry>
    <title>ä½ å¥½ï¼Œæˆ‘æ˜¯â€¦</title>
    <link href="https://levirve.github.io/2015/hello-world/"/>
    <id>https://levirve.github.io/2015/hello-world/</id>
    <published>2015-12-07T03:06:47.000Z</published>
    <updated>2015-12-07T04:38:48.000Z</updated>
    
    <content type="html"><![CDATA[
<p>Nå¹´å‰å°±èªªé‡è¿”ä¾†å¯«å¯«éƒ¨è½æ ¼è‡ªå¨›å¨›äººï¼Œç¾åœ¨çµ‚æ–¼æº–å‚™é–‹å§‹å•¦(å§?)<br><a id="more"></a></p>
<h2 id="u5F9E_u5C0F_u6211_u6709_u500B_u5922_uFF0C_u6211_u4E5F_u60F3_u50CFXXX_u4E00_u6A23"><a href="#u5F9E_u5C0F_u6211_u6709_u500B_u5922_uFF0C_u6211_u4E5F_u60F3_u50CFXXX_u4E00_u6A23" class="headerlink" title="å¾å°æˆ‘æœ‰å€‹å¤¢ï¼Œæˆ‘ä¹Ÿæƒ³åƒXXXä¸€æ¨£"></a>å¾å°æˆ‘æœ‰å€‹å¤¢ï¼Œæˆ‘ä¹Ÿæƒ³åƒXXXä¸€æ¨£</h2><p>å°æ™‚å€™(?!)é€›è‘—ç¶²ç«™ï¼Œç™¼ç¾çŸ¥åéƒ¨è½å®¢éƒ½åœ¨æ¨å‘å¦‚ä½•æ“æœ‰è‡ªå·±çš„ç¶²ç«™ï¼Œ<br>æ¯æ¬¡çœ‹å®Œæ¨å‘æ–‡ç¸½æ˜¯ <del>é ­æšˆæšˆ å·²æ¬²ç¡</del>ï¼Œæˆ‘æ˜¯èªª<strong>èˆˆå¥®é«˜æ˜‚</strong>ï¼<br>æ–¼æ˜¯å°±å¤¢æƒ³è‘—é•·å¤§å¾Œèƒ½æœ‰è‡ªå·±çš„ç¶²ç«™XD</p>
<h2 id="u6211_u6C92_u5C08_u696D_u6280_u80FD_u554AQQ"><a href="#u6211_u6C92_u5C08_u696D_u6280_u80FD_u554AQQ" class="headerlink" title="æˆ‘æ²’å°ˆæ¥­æŠ€èƒ½å•ŠQQ"></a>æˆ‘æ²’å°ˆæ¥­æŠ€èƒ½å•ŠQQ</h2><p>ä¿—è©±èªªé‚£å°±å»<strong>æ™ç¶“é©—å€¼é»å¤©è³¦å•Šï¼</strong></p>
<p>æ“ºå‡ºèµ·æ‰‹å¼ï¼Œæ‹¿å‡ºä¸Šå¤ç¥å™¨ WordPressï¼é å¤è¨˜æ†¶å·²ç¶“è¨˜ä¸æ¸…ç¬¬ä¸€æ¬¡é–‹å§‹å¼„æ˜¯ä»€éº¼æ™‚å€™äº†= = ä¸éå°±ç”¨æœ€è¿‘ä¸€æ¬¡æ¶ç«™æˆåŠŸä¾†èªªèªªæ•…äº‹å§ã€‚å°±åœ¨å»å¹´å¹´åˆï¼Œä¸€å¦‚å¾€å¸¸åœ¨çé€›ç¶²ç«™æ™‚ç™¼ç¾äº† <a href="https://www.openshift.com/" target="_blank" rel="external">OpenShift</a> é€™å€‹ PaaS( *aaS æ­£å¤¯ï¼å¿«è·Ÿä¸Šæ½®æµ )ï¼Œ<br>è€Œä¸”é–‹å•Ÿæœå‹™æ™‚å¯ä»¥ç›´æ¥é¸ç”¨ wordpress æ‡¶äººçµ„åˆåŒ…ï¼Œç›´æ¥å°±è£å¥½å•¦ XDDDD<br>æ‰€ä»¥æˆ‘èªªé›£åœ¨å“ªï¼Ÿ<strong>ç§‘æŠ€å§‹çµ‚ä¾†è‡ªäººæ€§ï¼Œæ‡¶äººçµ‚ç©¶ç²å¾—æ•‘è´–</strong></p>
<p>é™æƒ³å¾å‰å¾å‰å•Šï¼Œ</p>
<ul>
<li>å¿…é ˆè¦å…ˆå»ç§Ÿä¸€å°ä¸»æ©Ÿæˆ–è€…è‡ªå·±çš„é›»è…¦ç•¶ 24 hr always open çš„ç¶²ç«™ä¸»æ©Ÿä¼ºæœå™¨</li>
<li>è² è²¬è™•ç† HTTP è«‹æ±‚çš„ç¶²é ä¼ºæœå™¨ ( Apache ! å°±é˜¿å¸•å¥‘å•Šé€™é‚„è¦è§£é‡‹ï¼Ÿ )</li>
<li>è£å€‹èƒ½è·‘ PHP çš„ç’°å¢ƒ ( Linux æˆ– Windowséƒ½å¯ä»¥ )</li>
<li>è¨­å®šå¼„å¥½å­˜æ–‡ç« å…§å®¹çš„è³‡æ–™åº« ( é€šå¸¸æœƒç”¨ MySQL )</li>
</ul>
<p>æ–¼æ˜¯å‡ºç¾äº†å‚³å¥‡ç¶“å…¸çµ„åˆ LAMP ( Linux + Apache + MySQL + PHP ) ï¼Œä¸Šä¸–ä»£çš„æ½®æµï¼(å¼•æˆ°! XD)<br>ç”¨é€™å¥—å‚³å¥‡çµ„åˆæ­é… WordPress ï¼Œå°±åªèƒ½ç”¨ Legendary ä¾†è¨»è§£ã€‚<br><strong>è€é—†ï¼Œä¾†ä¸€ä»½å‚³èªªç´šå¥—é¤ï¼</strong></p>
<h2 id="u4EE5_u4E0B_u61F6_u4EBA_u5305"><a href="#u4EE5_u4E0B_u61F6_u4EBA_u5305" class="headerlink" title="ä»¥ä¸‹æ‡¶äººåŒ…"></a>ä»¥ä¸‹æ‡¶äººåŒ…</h2><p>ä¸éèª¤å…¥æ­§é€”å¤ªä¹…ï¼ŒæŠ€è¡“æ›äº†åˆæ›ï¼Œç¾åœ¨çµ‚æ–¼æ¶å‡ºè‡ªå·±çš„ç¶²ç«™å•¦ = =<br>æˆ‘éƒ½ä¸çŸ¥é“æ˜¯<strong>ç‚ºäº†å¯«éƒ¨è½æ ¼å­¸æŠ€è¡“ï¼Œé‚„æ˜¯å­¸äº†æŠ€è¡“å¯«éƒ¨è½æ ¼</strong> å›§rzzz<br>ä¸éå…‰é€™ç¯‡å“ˆå›‰ä¸–ç•Œèµ·æ‰‹æ–‡ä¿®ä¿®æ”¹æ”¹ä¹Ÿé™³æ”¾å¿«ä¸€å¹´äº†â€¦</p>
<p>æœ€è¿‘åœ¨ä¸­åœ‹çƒé›²ä¸Šçœ‹åˆ°ä¸€ç¯‡é—œæ–¼<a href="http://drops.wooyun.org/papers/10177" target="_blank" rel="external">ä¸­åœ‹ç¿»ç‰†çš„åŸç†èˆ‡å¯¦ç¾</a>ä¸€æ–‡ä¸­å¼•è¿°äº†ã€ˆè¥¿å»‚è¨ˆåŠƒã€‰çš„é€™æ®µè©±ï¼Œ</p>
<blockquote>
<p>æˆ‘æ˜¯ä¸€å€‹æ­»ææŠ€è¡“çš„ï¼Œå°±æ˜¯æ‰“ç®—ææŠ€è¡“åˆ°æ­»çš„é‚£ç¨®äººã€‚ï¼ï¼ã€ˆè¥¿å»‚è¨ˆåŠƒã€‰</p>
</blockquote>
<p>è®€å®Œé€™ç¯‡å„ªè³ªæ–‡çœŸæ˜¯<strong>å…§å¿ƒæ¾æ¹ƒ æ…·æ…¨æ¿€æ˜‚</strong><br>è‡ªç¨±ç‚ºä¸€å€‹æŠ€è¡“äººï¼Œå°±è¦å¹¹é»ç˜‹ç‹‚çš„äº‹ã€‚</p>
<p>Letâ€™s<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">==========================================</span><br><span class="line">Last login: Sun Dec  <span class="number">7</span> <span class="number">12</span>:<span class="number">21</span>:<span class="number">53</span> <span class="number">2015</span></span><br><span class="line"></span><br><span class="line">Yo, Salas! What would you like to <span class="keyword">do</span>?</span><br><span class="line">==========================================</span><br><span class="line"></span><br><span class="line">&gt; hack <span class="variable">$THE_WORLD</span></span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Nå¹´å‰å°±èªªé‡è¿”ä¾†å¯«å¯«éƒ¨è½æ ¼è‡ªå¨›å¨›äººï¼Œç¾åœ¨çµ‚æ–¼æº–å‚™é–‹å§‹å•¦(å§?)&lt;br&gt;
    
    </summary>
    
    
      <category term="Hello" scheme="https://levirve.github.io/tags/Hello/"/>
    
      <category term="Hexo" scheme="https://levirve.github.io/tags/Hexo/"/>
    
      <category term="é–‹ç®±æ–‡" scheme="https://levirve.github.io/tags/%E9%96%8B%E7%AE%B1%E6%96%87/"/>
    
  </entry>
  
  <entry>
    <title>Python å¥‡å¹»ä¹‹æ—…ï¼šæˆ‘åˆ°åº•çœ‹äº†ä»€éº¼ï¼</title>
    <link href="https://levirve.github.io/2015/python-fantasy/"/>
    <id>https://levirve.github.io/2015/python-fantasy/</id>
    <published>2015-07-09T14:52:00.000Z</published>
    <updated>2016-02-12T12:46:44.895Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Charpter_1"><a href="#Charpter_1" class="headerlink" title="Charpter 1"></a>Charpter 1</h1><img src="/2015/python-fantasy/fantasy.jpg" alt="photo-manipulation-digital-art-421405" title="photo-manipulation-digital-art-421405">
<a id="more"></a>
<h2 id="Python__u662F_u4EC0_u9EBC_uFF1F"><a href="#Python__u662F_u4EC0_u9EBC_uFF1F" class="headerlink" title="Python æ˜¯ä»€éº¼ï¼Ÿ"></a>Python æ˜¯ä»€éº¼ï¼Ÿ</h2><p>ä¸€ç¨®ç¨‹å¼èªè¨€ã€‚ä¸ç„¶é‚„èƒ½æ˜¯ä»€éº¼ï¼Ÿ<br><del>ç•¶ç„¶æ˜¯ä¸€ç¨®ä¿¡ä»°ã€‚</del></p>
<h2 id="Python__u53EF_u4EE5_u5E79_u561B_uFF1F"><a href="#Python__u53EF_u4EE5_u5E79_u561B_uFF1F" class="headerlink" title="Python å¯ä»¥å¹¹å˜›ï¼Ÿ"></a>Python å¯ä»¥å¹¹å˜›ï¼Ÿ</h2><ul>
<li>Webç¶²ç«™é–‹ç™¼ã€ç¶²è·¯æ‡‰ç”¨Appé–‹ç™¼</li>
<li>ç§‘å­¸è¨ˆç®—ã€æ•¸å€¼åˆ†æ</li>
<li>æ¡Œé¢åœ–å½¢åŒ–ç¨‹å¼</li>
<li>é©åˆæ•™å­¸å…¥é–€çš„ç¨‹å¼èªè¨€</li>
<li>è·¨å¹³å°ã€è·¨ä»‹é¢ï¼Œå¾ä¼ºæœå™¨ç«¯åˆ°ç”¨æˆ¶ç«¯ï¼›å¾èƒŒæ™¯è…³æœ¬åˆ°åœ–å½¢åŒ–ç¨‹å¼ï¼›å¾æ¡Œä¸Šå‹å€‹äººé›»è…¦åˆ°å°å°çš„å–®æ¿æ™¶ç‰‡ä¸Šï¼Œç”šè‡³åœ¨æ‰‹æ©Ÿä¸Šï¼ç°¡å–®ä¾†èªªï¼šåœ¨æ„æƒ³ä¸åˆ°çš„åœ°æ–¹ï¼Œ<strong>åšå‡ºå¾ˆé…·çš„æ±è¥¿ï¼</strong></li>
</ul>
<h2 id="u7A0B_u5F0F_u8A9E_u8A00_u90A3_u9EBC_u591A_uFF0C_u70BA_u4EC0_u9EBC_u9078_Python_uFF1F"><a href="#u7A0B_u5F0F_u8A9E_u8A00_u90A3_u9EBC_u591A_uFF0C_u70BA_u4EC0_u9EBC_u9078_Python_uFF1F" class="headerlink" title="ç¨‹å¼èªè¨€é‚£éº¼å¤šï¼Œç‚ºä»€éº¼é¸ Pythonï¼Ÿ"></a>ç¨‹å¼èªè¨€é‚£éº¼å¤šï¼Œç‚ºä»€éº¼é¸ Pythonï¼Ÿ</h2><ul>
<li>é«˜éšèªè¨€æ¥µå®¹æ˜“å­¸</li>
<li>è·¨å¹³å°ç§»æ¤æ€§é«˜</li>
<li>è±å¯Œçš„å‡½å¼åº«æ“´å……æ€§</li>
</ul>
<p>é–‹å§‹æ’°å¯«æ­¤æ–‡æ™‚ï¼Œæ°å·§çœ‹åˆ°è² è©•ç¶²ä¸­å°æ–¼å„ç¨‹å¼èªè¨€çš„è©•åƒ¹ã€‚å‰å¹¾é …é—œæ–¼ Python è©•åƒ¹ç›¸ç•¶æœ‰è¶£ï¼Œé«”ç¾å‡ºã€Œç°¡å–®è€Œå¯¦ç”¨ã€ç‰¹æ€§ã€‚</p>
<ul>
<li>å¯«èµ·ä¾†å¤ªçˆ½å®¹æ˜“å¯«åˆ°é«˜æ½®ï¼Œæ—äººéƒ½è¦ºå¾—æˆ‘æ€ªæ€ªçš„ã€‚<br>  ï¼ˆæˆ‘å®¤å‹éƒ½èªªæˆ‘å¯« Python æ™‚åƒç™¼é…’ç˜‹ï¼‰</li>
<li>æŠ•è³‡å ±é…¬ç‡å¤ªé«˜ï¼Œæ•™æˆä¸æ•¢æ•™ã€‚<br>  ï¼ˆä¿®èª²æ™‚æ›¾æœ‰æ¬¡ä½œæ¥­ä¸é™å®šç¨‹å¼èªè¨€ï¼Œç•¶ç„¶æ˜¯ç”¨ Python å¯«å›‰ï¼Œå˜¿å˜¿Ïƒ`âˆ€Â´)Ïƒï¼‰</li>
<li>å„é ˜åŸŸéƒ½è¢«<a href="http://zh.wikipedia.org/wiki/%E5%93%88%E5%88%A9%C2%B7%E6%B3%A2%E7%89%B9_%28%E8%A7%92%E8%89%B2%29" title="å‡ºè‡ªã€Šå“ˆåˆ©æ³¢ç‰¹ã€‹ï¼Œè›‡ä¹‹é–“çš„èªè¨€" target="_blank" rel="external">çˆ¬èªªèª</a>ä½”é ˜ï¼Œå¤ªé‚ªæƒ¡å•¦ï½<br>  ï¼ˆPython é€™å–®å­—åŸæ„å°±æ˜¯å·¨èŸ’ï¼Œç¾åœ¨äººäººéƒ½æ˜¯å“ˆåˆ©å•¦ï½ï¼‰</li>
<li>å­¸ <a href="#" title="ä»¥ã€Œå¹«åŠ©å¥³ç”Ÿå€‘é€²å…¥ Ruby ä»¥åŠ Rails çš„ä¸–ç•Œï¼Œä¸¦æœ‰èƒ½åŠ›å¯¦ç¾è‡ªå·±çš„é»å­èˆ‡ç†æƒ³ã€ç‚ºä¸»è¦è¨´æ±‚">RailsGirls</a> è¾¦ <a href="#" title="é€éåˆ†äº«ã€æ•™è‚²èˆ‡æœƒè­°ç­‰æ´»å‹•çš„æ–¹å¼å¹«åŠ©æ›´å¤šå¥³ç”Ÿå¯ä»¥åœ¨ Python ç¤¾ç¾¤ä¸­æˆç‚ºä¸»å‹•çš„åƒèˆ‡è€…èˆ‡é ˜å°è€…">PyLadies</a>ï¼Œå¯æƒ¡æƒ³å»ï¼<br>  ï¼ˆå¯æƒ¡æƒ³å»ï¼ï¼‰</li>
<li>è…³æœ¬èªè¨€æ•ˆç‡æœ‰é™ã€‚<br>  ï¼ˆæ‰€ä»¥å°±èªªè¦æŒ‘å°å ´åˆï¼Œç”¨å°æ‡‰çš„å·¥å…·å˜›ï¼ï¼‰</li>
</ul>
<p><img src="https://dl.dropboxusercontent.com/u/105585325/images/py-char.png" alt="Python Characters"></p>
<h2 id="u554A_uFF0C_u7136_u5F8C_u54A7_uFF1F"><a href="#u554A_uFF0C_u7136_u5F8C_u54A7_uFF1F" class="headerlink" title="å•Šï¼Œç„¶å¾Œå’§ï¼Ÿ"></a>å•Šï¼Œç„¶å¾Œå’§ï¼Ÿ</h2><p>æˆ‘å·²ç¶“çŸ¥é“ Python å¥½æ£’æ£’äº†ï¼Œé‚£åˆæ€æ¨£ï¼Ÿèªªå¥½çš„å¥‡å¹»ä¸–ç•Œå’§ï¼Ÿï¼ˆæ•²ç¢—ï¼‰<br>åˆ¥æ€¥åˆ¥æ€¥ï¼Œç¾åœ¨å°±ä¾†é€ èˆ¹å§ï¼ï¼ˆä»€éº¼ï¼Œç«Ÿç„¶è¦å¾é€™é–‹å§‹ï¼Ÿï¼å´©æ½°ï½ï¼‰</p>
<p>Mac è·Ÿ Linux ç™¼è¡Œæ¿åŸºæœ¬ä¸Šéƒ½æœ‰å…§å»º Python2.7ï¼Œä¸éä¹‹å¾Œéƒ½æ˜¯ç”¨ Python3 åšè¬›è§£å–”ï½è‡³æ–¼ç‚ºä»€éº¼ç­‰ç­‰æœƒèªªæ˜ã€‚<br>é€™é‚Šå°±ç”¨Debian / Ubuntu ç¤ºç¯„å®‰è£ Python3 å›‰ï¼š<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> install <span class="keyword">python3</span></span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœæ˜¯ Windows å‘¢ï¼Œå°±ç…§è‘—ä»¥ä¸‹æ­¥é©Ÿåšï¼š<br>è‡³<a href="https://www.python.org/downloads/" target="_blank" rel="external">Python å®˜æ–¹ç¶²ç«™</a>ä¸‹è¼‰å®‰è£æª”ã€‚</p>
<p>é€²å…¥é é¢å¾Œæœƒç™¼ç¾æœ‰å…©å€‹ç‰ˆæœ¬ï¼šåˆ†åˆ¥æ˜¯ 2.x å’Œ 3.x ç‰ˆï¼Œé‚£æ‡‰è©²é¸æ“‡å“ªå€‹å‘¢ï¼Ÿ<br>é€™é‚Šæ˜¯æœ‰å€‹å°æ•…äº‹ï¼šå› ç‚º Python 3 æ”¹å‹•çš„å…§å®¹ç„¡æ³•ä¿è­‰è®“èˆŠçš„ Python 2 ç¨‹å¼ç¢¼å®Œå…¨å‡ç´šæˆæ–°ç‰ˆï¼Œå¯èƒ½è®“åŸæœ¬ Python2 æ­£ç¢ºåŸ·è¡Œçš„ç¨‹å¼ç¢¼çˆ†ç‚¸ã€‚æœ€å¾Œ Python ç„¡æ³•å‹‰å¼·é–‹ç™¼è€…å…¨éƒ¨å‡ç´šï¼Œåªå¥½ç¹¼çºŒæ¨å‡ºå…©å€‹ç‰ˆæœ¬ï¼Œä¸éç›¸ä¿¡å…¨é¢æ›ä¸Š Python3 æ˜¯ä»¥å¾Œçš„è¶¨å‹¢ã€‚</p>
<p>é€™å°æ•…äº‹å‘Šè¨´æˆ‘å€‘<em>å…¼å®¹èˆŠç‰ˆ</em>çš„é‡è¦æ€§ï¼›ä¸éé€™ä¹Ÿä¸ä¸€å®šæ˜¯å¥½äº‹ï¼Œå¯èƒ½ç‚ºäº†å…¼å®¹æ€§è€Œè®“æ•´å€‹æ¶æ§‹è®Šå¾—æ›´è¤‡é›œï¼Œä¾‹å¦‚ï¼šIntelâ€¦ï¼Œé€™åˆæ˜¯é¡Œå¤–è©±äº†ã€‚ä¸éæ–°å…¥é–€ä¸¦æ²’æœ‰èˆŠç‰ˆåŒ…è¢±ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é¸æ“‡ Python 3ã€‚</p>
<p>Okay, æŒ‰ç…§å®‰è£æ­¥é©Ÿè£å¥½ Python ä¹‹å¾Œè¨˜å¾—å°‡ä½ å®‰è£çš„ Python ç›®éŒ„å¯«é€²ç³»çµ±<strong>ç’°å¢ƒè®Šæ•¸</strong>ï¼Œé€™é‚Šå› ç‚ºç­†è€…å€‹äººçš„ç®¡ç†ç¿’æ…£å°‡ä¹‹å®‰è£æ–¼ <code>C:\</code> æ§½åº•ä¸‹ã€‚ä¸¦å°‡ <code>C:\Python34</code> åŠ <code>C:\Python34\Scripts</code> åŠ å…¥ç’°å¢ƒè®Šæ•¸ã€‚ï¼ˆé€™é‚Šæ˜¯ä»¥å®‰è£ Python3.4 ç‚ºä¾‹ã€‚ï¼‰</p>
<p><img src="https://dl.dropboxusercontent.com/u/105585325/images/env_var.png" alt="System Enviroment Setting"></p>
<p>æ‰“é–‹å‘½ä»¤åˆ—è¼¸å…¥æŒ‡ä»¤ç¢ºèª<strong>ç’°å¢ƒè®Šæ•¸</strong>è¨­å®šæˆåŠŸï¼š<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>python -<span class="constant">V</span></span><br></pre></td></tr></table></figure></p>
<p>è‹¥è·³å‡ºå‰›å‰›é¸æ“‡å®‰è£çš„ç‰ˆæœ¬è™Ÿç¢¼ï¼Œå‰‡ä»£è¡¨è¨­å®šæˆåŠŸã€‚</p>
<p><img src="https://dl.dropboxusercontent.com/u/105585325/images/py-V.png" alt="Python Version"></p>
<h2 id="u51FA_u822A_u56C9_uFF01"><a href="#u51FA_u822A_u56C9_uFF01" class="headerlink" title="å‡ºèˆªå›‰ï¼"></a>å‡ºèˆªå›‰ï¼</h2><p>ç¬¬ä¸€æ¬¡å‡ºèˆªæˆ‘å€‘å…ˆç”¨å…§å»ºçš„ç·¨è¼¯å™¨ IDLEï¼Œå¾æ‡‰ç”¨ç¨‹å¼é¸å–®è£¡æ‰¾å‡º Python &gt; <code>IDLE(Python GUI)</code>ã€‚</p>
<p><img src="https://dl.dropboxusercontent.com/u/105585325/images/idle%20shell.png" alt="Python IDLE Shell"><br>é¸æ“‡ <code>File</code> &gt; <code>New File</code> é–‹å•Ÿæ–°æª”ï¼Œ<br>å¯«ä¸€é»ç¨‹å¼ç¢¼ã€‚æ²’éŒ¯ï¼Œå‚³èªªä¸­çš„ Hello Wolrdï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åå­— = input(<span class="string">'è¼¸å…¥åå­—: '</span>)</span><br><span class="line">print(<span class="string">'Hello'</span>, åå­—)</span><br></pre></td></tr></table></figure>
<p><img src="https://dl.dropboxusercontent.com/u/105585325/images/idle.png" alt="Python IDLE"><br>æŒ‰ä¸‹ <code>F5</code> åŸ·è¡Œï¼š</p>
<p><img src="https://dl.dropboxusercontent.com/u/105585325/images/idle%20shell%20run.png" alt="Python Hello run"></p>
<p>æ²’éŒ¯ï¼Œä½ å·²ç¶“å®Œæˆäº†ç¬¬ä¸€æ”¯ Python ç¨‹å¼å•¦ï½<br>ç›¡æƒ…äº«å— Python ä¹‹æ—…å§ï¼</p>
<p>Good luck !</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Charpter_1&quot;&gt;&lt;a href=&quot;#Charpter_1&quot; class=&quot;headerlink&quot; title=&quot;Charpter 1&quot;&gt;&lt;/a&gt;Charpter 1&lt;/h1&gt;&lt;img src=&quot;/2015/python-fantasy/fantasy.jpg&quot; alt=&quot;photo-manipulation-digital-art-421405&quot; title=&quot;photo-manipulation-digital-art-421405&quot;&gt;
    
    </summary>
    
    
      <category term="Python" scheme="https://levirve.github.io/tags/Python/"/>
    
  </entry>
  
</feed>
